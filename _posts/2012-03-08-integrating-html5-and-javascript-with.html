---
layout: post
title: Integrating HTML5 and Javascript with Windows Phone 7
date: '2012-03-08T22:57:00.001+01:00'
author: Christian Resma Helle
tags:
- Windows Phone 7
- Javascript
- HTML5
modified_time: '2012-03-09T23:29:57.513+01:00'
thumbnail: http://4.bp.blogspot.com/-Q2YUMg7r0PI/T1Zqdn7__UI/AAAAAAAAC2E/7PqcN7PY25Y/s72-c/JavascriptCSharpInterop.jpg
blogger_id: tag:blogger.com,1999:blog-4995334164049002857.post-2972343304265197073
blogger_orig_url: https://christian-helle.blogspot.com/2012/03/integrating-html5-and-javascript-with.html
---

Everyone, everywhere is talking about HTML5 these days. I myself did a recent talk at the <a href="2012/03/html5-and-windows-phone-7.html">Danish Developer Conference 2012 on Windows Phone and HTML5</a>. I get the point and I see the power and beauty of HTML5. But, HTML5 is as far as I can see not entirely ready yet and as for mobile applications, I would always choose writing a native application that takes full advantage of the platform and not just an application that runs in a browser, even if the the browser component is hosted in a native application. I think developers should really learn to appreciate the platform more.<br /><br />In this article I would like to explain how to integrate HTML5 + Javascript in a Windows Phone application and the same demonstrate how to call a .NET method from Javascript and how to call a Javascript method from .NET<br /><br />So here's what we need to do to get started:<br /><ol><li>Create a Windows Phone Silverlight application</li><li>Add a WebBrowser component on the main page</li><li>Set the <b>IsScriptEnabled </b>property of the WebBrowser component to <b>true</b></li><li>Add an event handler to the <b>ScriptNotify </b>event of the WebBrowser component</li><li>Create a folder on the project called HTML and add the HTML, Javascript, and Stylesheet assets to this folder</li><li>Write code to copy the HTML related assets to IsolatedStorage</li><li>Set the source of the WebBrowser component to the main HTML page</li></ol><div>Simple isn't it?<br /><br /><br /><b>How it works</b><br /><br />The steps above really do seem to be quite simple, and yes it really is. For Javascript to call into the host of the WebBrowser control we can use the <b>window.external.notify()</b>&nbsp;method. This is the same approach for having Javascript code execute code in the host application in other platforms. The <b>window.external.notify()</b>&nbsp;method takes a string which can be used to contain meta data that describes what you want the host to do. And for .NET code to execute Javascript code we use the <b>InvokeScript()</b>&nbsp;method of the WebBrowser control. The <b>InvokeScript()</b>&nbsp;method takes a string parameter that describes the Javascript method to execute, and a collection of strings that describe the arguments to be passed to the Javascript method to execute. If the method that will invoke a javascript function from the host is running on a non-UI thread (worker thread) then the best approach to using this method is by calling <b>InvokeScript("eval", "methodName(args1,args2,args3)")</b>&nbsp;instead of passing the name of the method to be invoked as the first method argument.<br /><br />Here's a diagram I used in DDC 2012 that illustrates the process mentioned above:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-Q2YUMg7r0PI/T1Zqdn7__UI/AAAAAAAAC2E/7PqcN7PY25Y/s1600/JavascriptCSharpInterop.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="408" src="http://4.bp.blogspot.com/-Q2YUMg7r0PI/T1Zqdn7__UI/AAAAAAAAC2E/7PqcN7PY25Y/s640/JavascriptCSharpInterop.jpg" width="640" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />For this example, we will have an application that hosts a HTML5 page that displays memory information of the device (as shown in the screenshot below)<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-YsTNlFM0edY/T1kqcu7_m1I/AAAAAAAAC2Y/m0LzyBJqXyY/s1600/HTML_WP7.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="640" src="http://3.bp.blogspot.com/-YsTNlFM0edY/T1kqcu7_m1I/AAAAAAAAC2Y/m0LzyBJqXyY/s640/HTML_WP7.png" width="337" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />And here's the code...<br /><br /><br /><b>Default.html (HTML5 + Javascript)</b><br /><br />The code below is going to be used as a local html file that is to be copied to isolated storage. Let's put this in a folder called HTML<br /><br /><div style="background: white; color: black; font-family: Consolas; font-size: 10pt;"><div style="margin: 0px;"><span style="color: blue;">&lt;!</span><span style="color: maroon;">DOCTYPE</span> <span style="color: red;">html</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;"><span style="color: blue;">&lt;</span><span style="color: maroon;">html</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;"><span style="color: blue;">&lt;</span><span style="color: maroon;">head</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">meta</span> <span style="color: red;">name</span><span style="color: blue;">="viewport"</span> <span style="color: red;">content</span><span style="color: blue;">="width=480, height=800, user-scalable=no"</span> <span style="color: blue;">/&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">meta</span> <span style="color: red;">name</span><span style="color: blue;">="MobileOptimized"</span> <span style="color: red;">content</span><span style="color: blue;">="width"</span> <span style="color: blue;">/&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">meta</span> <span style="color: red;">name</span><span style="color: blue;">="HandheldFriendly"</span> <span style="color: red;">content</span><span style="color: blue;">="true"</span> <span style="color: blue;">/&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">title</span><span style="color: blue;">&gt;</span>HTML5 and Windows Phone 7<span style="color: blue;">&lt;/</span><span style="color: maroon;">title</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">style</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: maroon;">body</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">color</span>: <span style="color: blue;">White</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">background-color</span>: <span style="color: blue;">Black</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">font-family</span>: <span style="color: blue;">'Segoe WP Semibold'</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">text-align</span>: <span style="color: blue;">left</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: maroon;">h3</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">font-size</span>: <span style="color: blue;">20pt</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: maroon;">input</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">color</span>: <span style="color: blue;">#ffffff</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">background-color</span>: <span style="color: blue;">#000000</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">border</span>: <span style="color: blue;">2px</span> <span style="color: blue;">solid</span> <span style="color: blue;">white</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">vertical-align</span>: <span style="color: blue;">baseline</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">font-size</span>: <span style="color: blue;">17pt</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">min-width</span>: <span style="color: blue;">40px</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">min-height</span>: <span style="color: blue;">40px</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: red;">margin</span>: <span style="color: blue;">5</span>;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">style</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;"><span style="color: blue;">&lt;/</span><span style="color: maroon;">head</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;"><span style="color: blue;">&lt;</span><span style="color: maroon;">body</span> <span style="color: red;">onload</span><span style="color: blue;">="onLoad()"&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">div</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">h3</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Current memory usage:<span style="color: blue;">&lt;/</span><span style="color: maroon;">h3</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">input</span> <span style="color: red;">id</span><span style="color: blue;">="memoryUsage"</span> <span style="color: red;">type</span><span style="color: blue;">="text"</span> <span style="color: red;">value</span><span style="color: blue;">="0"</span> <span style="color: blue;">/&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">h3</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Memory usage limit:<span style="color: blue;">&lt;/</span><span style="color: maroon;">h3</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">input</span> <span style="color: red;">id</span><span style="color: blue;">="memoryUsageLimit"</span> <span style="color: red;">type</span><span style="color: blue;">="text"</span> <span style="color: red;">value</span><span style="color: blue;">="0"</span> <span style="color: blue;">/&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">h3</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Peak memory usage:<span style="color: blue;">&lt;/</span><span style="color: maroon;">h3</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">input</span> <span style="color: red;">id</span><span style="color: blue;">="peakMemoryUsage"</span> <span style="color: red;">type</span><span style="color: blue;">="text"</span> <span style="color: red;">value</span><span style="color: blue;">="0"</span> <span style="color: blue;">/&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">h3</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Total memory:<span style="color: blue;">&lt;/</span><span style="color: maroon;">h3</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">input</span> <span style="color: red;">id</span><span style="color: blue;">="totalMemory"</span> <span style="color: red;">type</span><span style="color: blue;">="text"</span> <span style="color: red;">value</span><span style="color: blue;">="0"</span> <span style="color: blue;">/&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">div</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;</span><span style="color: maroon;">script</span> <span style="color: red;">type</span><span style="color: blue;">="text/javascript"&gt;</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">function</span> onLoad() {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; window.external.notify(<span style="color: maroon;">"getMemoryUsage"</span>);</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;"><br /></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">function</span> getMemoryUsageCallback(memoryUsage, memoryUsageLimit, peakMemoryUsage, totalMemory) {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; document.getElementById(<span style="color: maroon;">"memoryUsage"</span>).value = memoryUsage;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; document.getElementById(<span style="color: maroon;">"memoryUsageLimit"</span>).value = memoryUsageLimit;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; document.getElementById(<span style="color: maroon;">"peakMemoryUsage"</span>).value = peakMemoryUsage;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; document.getElementById(<span style="color: maroon;">"totalMemory"</span>).value = totalMemory;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;/</span><span style="color: maroon;">script</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;"><span style="color: blue;">&lt;/</span><span style="color: maroon;">body</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;"><span style="color: blue;">&lt;/</span><span style="color: maroon;">html</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;"><br /></div></div><br /><b>MainPage.xaml</b><br /><br />The code below is the main page of the Silverlight application that will host the HTML content<br /><br /><div style="background: white; color: black; font-family: Consolas; font-size: 10pt;"><div style="margin: 0px;"><span style="color: blue;">&lt;</span><span style="color: #a31515;">phone</span><span style="color: blue;">:</span><span style="color: #a31515;">PhoneApplicationPage</span><span style="color: red;"> x</span><span style="color: blue;">:</span><span style="color: red;">Class</span><span style="color: blue;">="PhoneApp.MainPage"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> xmlns</span><span style="color: blue;">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> xmlns</span><span style="color: blue;">:</span><span style="color: red;">x</span><span style="color: blue;">="http://schemas.microsoft.com/winfx/2006/xaml"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> xmlns</span><span style="color: blue;">:</span><span style="color: red;">phone</span><span style="color: blue;">="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> xmlns</span><span style="color: blue;">:</span><span style="color: red;">shell</span><span style="color: blue;">="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> xmlns</span><span style="color: blue;">:</span><span style="color: red;">d</span><span style="color: blue;">="http://schemas.microsoft.com/expression/blend/2008"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> xmlns</span><span style="color: blue;">:</span><span style="color: red;">mc</span><span style="color: blue;">="http://schemas.openxmlformats.org/markup-compatibility/2006"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> mc</span><span style="color: blue;">:</span><span style="color: red;">Ignorable</span><span style="color: blue;">="d"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> d</span><span style="color: blue;">:</span><span style="color: red;">DesignWidth</span><span style="color: blue;">="480"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> d</span><span style="color: blue;">:</span><span style="color: red;">DesignHeight</span><span style="color: blue;">="768"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> FontFamily</span><span style="color: blue;">="{</span><span style="color: #a31515;">StaticResource</span><span style="color: red;"> PhoneFontFamilyNormal</span><span style="color: blue;">}"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> FontSize</span><span style="color: blue;">="{</span><span style="color: #a31515;">StaticResource</span><span style="color: red;"> PhoneFontSizeNormal</span><span style="color: blue;">}"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> Foreground</span><span style="color: blue;">="{</span><span style="color: #a31515;">StaticResource</span><span style="color: red;"> PhoneForegroundBrush</span><span style="color: blue;">}"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> SupportedOrientations</span><span style="color: blue;">="Portrait"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> Orientation</span><span style="color: blue;">="Portrait"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> shell</span><span style="color: blue;">:</span><span style="color: red;">SystemTray.IsVisible</span><span style="color: blue;">="True"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: red;"> Loaded</span><span style="color: blue;">="PhoneApplicationPage_Loaded"&gt;</span></div><div style="margin: 0px;"><br /></div><div style="margin: 0px;"><span style="color: #a31515;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">&lt;</span><span style="color: #a31515;">Grid</span><span style="color: red;"> x</span><span style="color: blue;">:</span><span style="color: red;">Name</span><span style="color: blue;">="LayoutRoot"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color: red;"> Background</span><span style="color: blue;">="Transparent"&gt;</span></div><div style="margin: 0px;"><span style="color: #a31515;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue;">&lt;</span><span style="color: #a31515;">phone</span><span style="color: blue;">:</span><span style="color: #a31515;">WebBrowser</span><span style="color: red;"> Name</span><span style="color: blue;">="browser"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color: red;"> IsScriptEnabled</span><span style="color: blue;">="True"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color: red;"> Source</span><span style="color: blue;">="HTML/Default.html"</span></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color: red;"> ScriptNotify</span><span style="color: blue;">="browser_ScriptNotify" /&gt;</span></div><div style="margin: 0px;"><span style="color: #a31515;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">&lt;/</span><span style="color: #a31515;">Grid</span><span style="color: blue;">&gt;</span></div><div style="margin: 0px;"><br /></div><div style="margin: 0px;"><span style="color: blue;">&lt;/</span><span style="color: #a31515;">phone</span><span style="color: blue;">:</span><span style="color: #a31515;">PhoneApplicationPage</span><span style="color: blue;">&gt;</span></div></div><br /><br /><b>MainPage.xaml.cs</b><br /><br />And here's the code behind the xaml file<br /><br /><div style="background: white; color: black; font-family: Consolas; font-size: 10pt;"><div style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: #2b91af;">MainPage</span> : <span style="color: #2b91af;">PhoneApplicationPage</span></div><div style="margin: 0px;">{</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> MainPage()</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; InitializeComponent();</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;"><br /></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> PhoneApplicationPage_Loaded(<span style="color: blue;">object</span> sender, <span style="color: #2b91af;">RoutedEventArgs</span> e)</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: #2b91af;">IsolatedStorageFile</span> store = <span style="color: #2b91af;">IsolatedStorageFile</span>.GetUserStoreForApplication())</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (!store.DirectoryExists(<span style="color: #a31515;">"HTML"</span>)) store.CreateDirectory(<span style="color: #a31515;">"HTML"</span>);</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CopyToIsolatedStorage(<span style="color: #a31515;">"HTML\\Default.html"</span>, store);</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;"><br /></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">static</span> <span style="color: blue;">void</span> CopyToIsolatedStorage(<span style="color: blue;">string</span> file, <span style="color: #2b91af;">IsolatedStorageFile</span> store, <span style="color: blue;">bool</span> overwrite = <span style="color: blue;">true</span>)</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (store.FileExists(file) &amp;&amp; !overwrite)</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">return</span>;</div><div style="margin: 0px;"><br /></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: #2b91af;">Stream</span> resourceStream = <span style="color: #2b91af;">Application</span>.GetResourceStream(<span style="color: blue;">new</span> <span style="color: #2b91af;">Uri</span>(file, <span style="color: #2b91af;">UriKind</span>.Relative)).Stream)</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: #2b91af;">IsolatedStorageFileStream</span> fileStream = store.OpenFile(file, <span style="color: #2b91af;">FileMode</span>.Create, <span style="color: #2b91af;">FileAccess</span>.ReadWrite, <span style="color: #2b91af;">FileShare</span>.ReadWrite))</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span> bytesRead;</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> buffer = <span style="color: blue;">new</span> <span style="color: blue;">byte</span>[resourceStream.Length];</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">while</span> ((bytesRead = resourceStream.Read(buffer, 0, buffer.Length)) &gt; 0)</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fileStream.Write(buffer, 0, bytesRead);</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;"><br /></div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">void</span> browser_ScriptNotify(<span style="color: blue;">object</span> sender, <span style="color: #2b91af;">NotifyEventArgs</span> e)</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> response = <span style="color: blue;">new</span> <span style="color: blue;">object</span>[]</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; {</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: #2b91af;">DeviceStatus</span>.ApplicationCurrentMemoryUsage, </div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: #2b91af;">DeviceStatus</span>.ApplicationMemoryUsageLimit, </div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: #2b91af;">DeviceStatus</span>.ApplicationPeakMemoryUsage,</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: #2b91af;">DeviceStatus</span>.DeviceTotalMemory</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; };</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; browser.InvokeScript(<span style="color: #a31515;">"getMemoryUsageCallback"</span>, response.Select(c =&gt; c.ToString()).ToArray());</div><div style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</div><div style="margin: 0px;">}</div></div><br />What happens in the code above is that when the main page has loaded, the html assets are copied to isolated storage and loaded into the web browser component as a local file. When <a href="http://msdn.microsoft.com/en-us/library/microsoft.phone.controls.webbrowser.scriptnotify(v=vs.92).aspx">ScriptNotify</a> is triggered, the Silverlight application retrieves memory information using the <a href="http://msdn.microsoft.com/en-us/library/ff941122(v=vs.92).aspx">DeviceStatus</a> class and passes this information back to the WebBrowser component by invoking the getMemoryUsageCallback() method using the <a href="http://msdn.microsoft.com/en-us/library/ff402855(v=vs.92).aspx">InvokeScript()</a> method of the WebBrowser component<br /><br />The sample above is a very basic and naive but it demonstrates something that can provide endless platform interop possibilities. I hope you found this useful.</div><br />You can grab the full source code the sample above here:<br /><iframe title ="Preview" scrolling="no" marginheight="0" marginwidth="0" frameborder="0" width="98px" height="120px" style="padding:0;background-color:#fcfcfc;" src="https://skydrive.live.com/embed?cid=CA531E7FB4762C70&resid=CA531E7FB4762C70%21846&authkey=AIlgEO7SWk3fIeY"></iframe>