---
layout: post
title: Working around Pivot SelectedIndex limitations in Windows Phone 7
date: '2011-02-05T00:30:00.001+01:00'
author: Christian Resma Helle
tags:
- Windows Phone 7
modified_time: '2011-02-05T00:30:00.358+01:00'
blogger_id: tag:blogger.com,1999:blog-4995334164049002857.post-566654096796432301
blogger_orig_url: https://christian-helle.blogspot.com/2011/02/working-around-pivot-selectedindex.html
---

I've been working on an application with 2 pages, a main page and a content page. The content page contains a Pivot control with a few pivot items. The main page does nothing but navigate to the content page and suggest which pivot item to display. The only reason the main page exists is to display the information in the pivot item headers in a more graphical and elegant way.  <br/><br/>For some reason I can't set the displayed pivot index to be the third item. I wanted to do this on the OnNavigatedTo event of the content page but whenever I attempt doing so an exception is thrown. Every other pivot item works fine, which I think is really weird.  <br/><br/>To load the content page, I navigate to the page by passing some information of the pivot index I wish to be displayed. Something like this:  <br/><br/><div style="font-family: Consolas; font-size: 10pt; color: black; background: white;"><pre style="margin: 0px;">NavigationService.Navigate(<span style="color: blue;">new</span> <span style="color: #2b91af;">Uri</span>(<span style="color: #a31515;">&quot;/ContentPage.xaml?index=&quot;</span> + index, <span style="color: #2b91af;">UriKind</span>.Relative));</pre></div> <br/><br/>If the value of index in the code above is set to 2 then I get an exception, any other valid value works fine. A value out of range (less than 0 or greater than 5) throws an out of range exception which is the behavior anyone would expect.  <br/><br/>Here's the XAML definition of the content page  <br/><br/><div style="font-family: Fixedsys; font-size: 10pt; color: black; background: white;"><pre style="margin: 0px;"><span style="color: blue;">&lt;</span><span style="color: #a31515;">phone:PhoneApplicationPage</span></pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">x:Class</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">WindowsPhonePivotApplication.ContentPage</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">xmlns</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">xmlns:x</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">http://schemas.microsoft.com/winfx/2006/xaml</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">xmlns:phone</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">xmlns:shell</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">xmlns:controls</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">xmlns:d</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">http://schemas.microsoft.com/expression/blend/2008</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">xmlns:mc</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">http://schemas.openxmlformats.org/markup-compatibility/2006</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">mc:Ignorable</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">d</span>&quot;<span style="color: blue;"> </span><span style="color: red;">d:DesignWidth</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">480</span>&quot;<span style="color: blue;"> </span><span style="color: red;">d:DesignHeight</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">768</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">FontFamily</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">{StaticResource PhoneFontFamilyNormal}</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">FontSize</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">{StaticResource PhoneFontSizeNormal}</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">Foreground</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">{StaticResource PhoneForegroundBrush}</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">SupportedOrientations</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">Portrait</span>&quot;<span style="color: blue;">&nbsp; </span><span style="color: red;">Orientation</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">Portrait</span>&quot;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; </span><span style="color: red;">shell:SystemTray.IsVisible</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">True</span>&quot;<span style="color: blue;">&gt;</span></pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &lt;</span><span style="color: #a31515;">Grid</span><span style="color: blue;"> </span><span style="color: red;">x:Name</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">LayoutRoot</span>&quot;<span style="color: blue;"> </span><span style="color: red;">Background</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">Transparent</span>&quot;<span style="color: blue;">&gt;</span></pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; &lt;</span><span style="color: #a31515;">controls:Pivot</span><span style="color: blue;"> </span><span style="color: red;">Name</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">pivot</span>&quot;<span style="color: blue;"> </span><span style="color: red;">Title</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">CONTENT PAGE</span>&quot;<span style="color: blue;">&gt;</span></pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; &nbsp; &lt;</span><span style="color: #a31515;">controls:PivotItem</span><span style="color: blue;"> </span><span style="color: red;">Header</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">first</span>&quot;<span style="color: blue;"> /&gt;</span></pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; &nbsp; &lt;</span><span style="color: #a31515;">controls:PivotItem</span><span style="color: blue;"> </span><span style="color: red;">Header</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">second</span>&quot;<span style="color: blue;"> /&gt;</span></pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; &nbsp; &lt;</span><span style="color: #a31515;">controls:PivotItem</span><span style="color: blue;"> </span><span style="color: red;">Header</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">third</span>&quot;<span style="color: blue;"> /&gt;</span></pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; &nbsp; &lt;</span><span style="color: #a31515;">controls:PivotItem</span><span style="color: blue;"> </span><span style="color: red;">Header</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">fourth</span>&quot;<span style="color: blue;"> /&gt;</span></pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; &nbsp; &lt;</span><span style="color: #a31515;">controls:PivotItem</span><span style="color: blue;"> </span><span style="color: red;">Header</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">fifth</span>&quot;<span style="color: blue;"> /&gt;</span></pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; &nbsp; &lt;</span><span style="color: #a31515;">controls:PivotItem</span><span style="color: blue;"> </span><span style="color: red;">Header</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">sixth</span>&quot;<span style="color: blue;"> /&gt;</span></pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &nbsp; &lt;/</span><span style="color: #a31515;">controls:Pivot</span><span style="color: blue;">&gt;</span></pre><pre style="margin: 0px;"><span style="color: blue;">&nbsp; &lt;/</span><span style="color: #a31515;">Grid</span><span style="color: blue;">&gt;</span></pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;"><span style="color: blue;">&lt;/</span><span style="color: #a31515;">phone:PhoneApplicationPage</span><span style="color: blue;">&gt;</span></pre></div> <br/><br/>To work around this limitation, you can handle the Loaded event of the page and update the pivot selected index from there. Here's an example how to do it:  <br/><br/><div style="font-family: Consolas; font-size: 10pt; color: black; background: white;"><pre style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: #2b91af;">ContentPage</span> : <span style="color: #2b91af;">PhoneApplicationPage</span></pre><pre style="margin: 0px;">{</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">int</span> pivotIndex;</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> ContentPage()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; InitializeComponent();</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Loaded += <span style="color: blue;">delegate</span> { pivot.SelectedIndex = pivotIndex; };</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">protected</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> OnNavigatedTo(<span style="color: #2b91af;">NavigationEventArgs</span> e)</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> value;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (NavigationContext.QueryString.TryGetValue(<span style="color: #a31515;">&quot;index&quot;</span>, <span style="color: blue;">out</span> value))</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; pivotIndex = 0;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue;">int</span>.TryParse(value, <span style="color: blue;">out</span> pivotIndex);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">}</pre></div> <br/><br/>I'm not sure if this limitation is by design or it's a bug in the control. Either way I managed to get it to work the way I wanted it to. Hopefully I'm not the only one who ran across this and that you found this information useful.