---
layout: post
title: Accessing Windows Mobile 6.0 Sound API's through .NETCF
date: '2007-07-09T10:34:00.001+02:00'
# author: Christian Resma Helle
tags:
- ".NET Compact Framework"
- Windows Mobile 6.0
modified_time: '2009-05-06T12:19:36.882+02:00'
blogger_id: tag:blogger.com,1999:blog-4995334164049002857.post-2335941440338487316
blogger_orig_url: https://christian-helle.blogspot.com/2007/06/accessing-windows-mobile-60-sound-apis.html
---

A new set of APIs were introduced in Windows Mobile 6 to make it easier to manage and play sound. The new API's support playing sounds in a variety of formats that Windows Media Player supports<br /><br />These API's are really easy to use. You can play a sound file with a single function call. Let's try to do that through .NETCF by P/Invoking SndPlaySync(LPCTSTR pszSoundFile, DWORD dwFlags).<br /><br /><font face="Courier"><br />[<font color="#408080">DllImport</font>(<font color="Red">"aygshell.dll"</font>)]<br /><font color="Blue">static extern uint</font> SndPlaySync(<font color="Blue">string</font> pszSoundFile, <font color="Blue">uint</font> dwFlags);<br /><br /><font color="Blue">void</font> PlaySound() {<br />&nbsp;&nbsp;SndPlaySync(<font color="Red">"\\Storage Card\\Intro.mp3"</font>, 0);<br />}<br /></font><br /><br />In the previous sample, we are playing a sound file synchronously. Now, this is interesting in a way that its very very easy to play an audio file. But what really gets interesting is that the new Sound API provides methods for playing sound files asynchronously.<br /><br />To play audio files asynchronously, we will need to call 4 methods from the Sound API.<br /><br />&nbsp;&nbsp;SndOpen(LPCTSTR pszSoundFile, HSOUND* phSound)<br />&nbsp;&nbsp;SndPlayAsync(HSOUND hSound, DWORD dwFlags)<br />&nbsp;&nbsp;SndClose(HSOUND hSound)<br />&nbsp;&nbsp;SndStop(SND_SCOPE SoundScope, HSOUND hSound)<br /><br />Let's start by declare our P/Invokes<br /><br /><font face="Courier"><br />[<font color="#408080">DllImport</font>(<font color="Red">"aygshell.dll"</font>)]<br /><font color="Blue">static extern uint</font> SndOpen(<font color="Blue">string</font> pszSoundFile, <font color="Blue">ref</font> <font color="#408080">IntPtr</font> phSound);<br />  <br />[<font color="#408080">DllImport</font>(<font color="Red">"aygshell.dll"</font>)]<br /><font color="Blue">static extern uint</font> SndPlayAsync(<font color="#408080">IntPtr</font> hSound, <font color="Blue">uint</font> dwFlags);<br /><br />[<font color="#408080">DllImport</font>(<font color="Red">"aygshell.dll"</font>)]<br /><font color="Blue">static extern uint</font> SndClose(<font color="#408080">IntPtr</font> hSound);<br /><br />[<font color="#408080">DllImport</font>(<font color="Red">"aygshell.dll"</font>)]<br /><font color="Blue">static extern uint</font> SndStop(<font color="Blue">int</font> SoundScope, <font color="#408080">IntPtr</font> hSound);<br /></font><br /><br />Now that we have our P/Invokes ready. Let's start playing with the Sound API in .NETCF. In the sample below, the application will play the audio file Intro.mp3 located in the Storage Card. To play an Audio file asynchronously, we will first need a handle to the audio file. We use SndOpen(string, IntPtr) to accomplish that. Once we have the handle to the audio file, we can call SndPlayAsync(IntPtr, int) to start playing the audio file. To stop playing the audio we just have to close the handle and call SndStop(SND_SCOPE_PROCESS, IntPtr.Zero) to stop the playback of the sound.<br /><br /><font face="Courier"><br /><font color="#408080">IntPtr</font> hSound = <font color="#408080">IntPtr</font>.Zero;<br /><font color="Blue">const string</font> AUDIO_FILE = <font color="Red">"\\Storage Card\\Intro.mp3"</font>;<br /><font color="Blue">const int</font> SND_SCOPE_PROCESS = 0x1;<br /><br /><font color="Blue">void</font> Play() {<br />&nbsp;&nbsp;SndOpen(AUDIO_FILE, <font color="Blue">ref</font> hSound);<br />&nbsp;&nbsp;SndPlayAsync(hSound, 0);<br />}<br /><br /><font color="Blue">void</font> Stop() {<br />&nbsp;&nbsp;SndClose(hSound);<br />&nbsp;&nbsp;SndStop(SND_SCOPE_PROCESS, <font color="#408080">IntPtr</font>.Zero);<br />} <br /></font><br /><br />How cool is that? You can now easily add some cool sound effects to your application. Maybe even use the Sound API for one of those annoying startup sounds!