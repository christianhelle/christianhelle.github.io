---
layout: post
title: Generate Resx Translations from Google Sheets
date: '2019-06-12T22:30:00.002+02:00'
# author: Christian Resma Helle
tags:
- Localization
- Xamarin
modified_time: '2019-06-13T09:28:50.488+02:00'
thumbnail: https://1.bp.blogspot.com/-lldRsH8dOVk/XQFZ1BrC4aI/AAAAAAAAWL4/awcO8fBQ_5UuoCVeLl9ELkta7R051iCpwCEwYBhgL/s72-c/GoogleSheets.png
blogger_id: tag:blogger.com,1999:blog-4995334164049002857.post-4089591479727741453
blogger_orig_url: https://christian-helle.blogspot.com/2019/06/generate-resx-translations-using-google.html
---

In my career, I have tried multiple translation tools for handling localization. This usually ends up in a spreadsheet sent back and forth that gets imported/exported with the actual translation tool. I have also tried giving my translators and customers direct access to the translation tool but that never really worked as they tend to blindly translate everything they see and usually miss out on the fact that some strings contain important placeholders that executable code expects. Anyway, at the end of the sending a spreadsheet back and forth seems to always work.<br /><br />In a recent project, I built an Android and iOS app with Xamarin.Forms that used Resx files for handling cross platform translations, and InfoPlist.strings files in iOS for localizing OS requirement prompts for using things like Camera, Localization, Photos, etc. For this project we thought about playing around with Google Sheets as a translation tool. Google Sheets has built in Google Translate support so you can do something like <b>=GOOGLETRANSLATE($B2,$B$1,C$1)</b> where <b>$B2</b> describes the text to translate, <b>$B1</b> describes the source language, in this case English is the default, and<b> $C1</b> describes the language to translate to. With this approach, I can very easily, blindly, add new translations to my app, like in <a href="http://docs.google.com/spreadsheets/d/1icJ0a48MIIRkbHSIbPyLNXsbTZcPKI_U80QwdX5pWf8">this sample</a> Google Sheets document, where I added Danish, German, Filipino, Simplified Chinese, Japanese, and Koreanusing the Google Translate tool. Of course, this needs to be proof-read by a translation professional who mastered the language, but this approach is very convenient for checking out how the app looks like in different languages.<br /><br />Now here’s the awesome part. My colleague and good friend, <a href="https://twitter.com/rickykaare">Ricky Kaare Engelharth</a>, created a translation tool called <a href="https://github.com/rickykaare/csvtrans">csvtrans </a>that can produce Resx, iOS, and Android translation files from a publicly available Google Sheets document. The tool is written in .NET Core and is publicly available from <a href="https://www.nuget.org/packages/csvtrans">nuget.org</a> as a tool.<br /><br />The tool can be installed using this command<br /><pre><code><br /><b>dotnet tool install -g csvtrans</b><br /></code><br /></pre><br />Using the tool is also straight forward and it also comes with some quick start instructions<br /><pre><code><br /><b>USAGE: csvtrans [--help] [--sheet &lt;document id&gt; &lt;sheet name&gt;]<br />                [--csv &lt;url or path&gt;] [--format &lt;apple|android|resx&gt;]<br />                [--outputdir &lt;directory path&gt;] [--name &lt;string&gt;]<br />                [--convert-placeholders &lt;regex pattern&gt;]<br /><br />OPTIONS:<br /><br />    --sheet, -s &lt;document id&gt; &lt;sheet name&gt;<br />                          specify a Google Sheet as input.<br />    --csv, -c &lt;url or path&gt;<br />                          specify a online or local cvs file as input.<br />    --format, -f &lt;apple|android|resx&gt;<br />                          specify the output format.<br />    --outputdir, -o &lt;directory path&gt;<br />                          specify the output directory.<br />    --name, -n &lt;string&gt;   specify an optional name for the output.<br />    --convert-placeholders, -p &lt;regex pattern&gt;<br />                          convert placeholders to match the output format.<br />    --help                display this list of options.</b><br /></code></pre><br />Here’s an example usage of the tool<br /><pre><code><br /><b>csvtrans --sheet 1icJ0a48MIIRkbHSIbPyLNXsbTZcPKI_U80QwdX5pWf8 Resx --format resx --outputdir .\Resources</b><br /></code></pre><br />The first argument <code><b>–-sheet</b></code> is the Google Sheet document ID followed by the Sheet Name, the next argument <code><b>–-format</b></code> specifies the output file format, and the last argument <code><b>–-outputdir</b></code> specifies the output folder.<br /><br />You can get the Document ID from the URL of the Google Sheet<br /><br /><img src="https://1.bp.blogspot.com/-lldRsH8dOVk/XQFZ1BrC4aI/AAAAAAAAWL4/awcO8fBQ_5UuoCVeLl9ELkta7R051iCpwCEwYBhgL/s1600/GoogleSheets.png" /><br /><br />Here's an example output<br /><br /><img src="https://1.bp.blogspot.com/-W7gArGEqrCM/XQFdfzejnaI/AAAAAAAAWMQ/QHqYlLB59AclpUeBbvqVQjBpfSrPxx1fgCLcBGAs/s1600/csvtrans-output.png" /><br /><br />Now I can just bring these files into my project and use them directly. With the modern csproj format I don't even need to do any changes to include these translation files, as long as the resx files are in the project folder they will be automagically included into the output. This opens up for dynamic translations at build time using your CI/CD build tools of choice