---
layout: post
title: Programmatically Minimize an Application in .NET CF 2.0
date: '2007-06-06T13:53:00.000+02:00'
# author: Christian Resma Helle
tags:
- Windows Mobile
- ".NET Compact Framework"
modified_time: '2007-06-11T09:45:53.706+02:00'
blogger_id: tag:blogger.com,1999:blog-4995334164049002857.post-3618804870290246980
blogger_orig_url: https://christian-helle.blogspot.com/2007/06/programmatically-minimize-application.html
---

I once made a solution that runs on full screen. The solution was written completely in managed code (except for the CE Setup and other small stuff..). Since I took over the screen completely, I don't have access to the (X) button in the upper right corner of the screen. I wanted the application running at all times, but I also wanted the user to be able to get in and out of the application. Since the user won't be able to access the Start button, I added a "Close" button to my application. This "Close" button won't exit the application, instead it will just Minimize the application.<br /><br />In the .NET Compact Framework 2.0, you can't just set the form's <font face="Courier">WindowState</font> to <font face="Courier">WindowState.Minimized</font> since the <font face="Courier">WindowState</font> enum only contains <font face="Courier">Normal</font> and <font face="Courier">Maximized</font>. Currently, the only way you can programmatically minimize an application is by doing a P/Invoke to <font face="Courier">ShowWindow</font> and passing <font face="Courier">SW_MINIMIZE</font> to specify how the window will be displayed. It is also required that your Form has the Taskbar visible, this is done by setting the following properties:<br /><font face="Courier" size=2><br />&nbsp;&nbsp;FormBorderStyle = FormBorderStyle.FixedDialog;<br />&nbsp;&nbsp;WindowState = FormWindowState.Normal;<br />&nbsp;&nbsp;ControlBox = <font color="Blue">true</font>;<br />&nbsp;&nbsp;MinimizeBox = <font color="Blue">true</font>;<br />&nbsp;&nbsp;MaximizeBox = <font color="Blue">true</font>;<br /></font><br />Here's a small code snippet of how to minimize your application<br /><font face="Courier"><br />[<font color="#408080">DllImport</font>(<font color="Red">"coredll.dll"</font>)]<br /><font color="Blue">static extern int </font>ShowWindow(<font color="#408080">IntPtr</font> hWnd, <font color="Blue">int</font> nCmdShow);<br /><br /><font color="Blue">const int</font> SW_MINIMIZED = 6;<br /><br /><font color="Blue">void</font> Minimize() {<br />&nbsp;&nbsp;<font color="Green">// The Taskbar must be enabled to be able to do a Smart Minimize</font><br />&nbsp;&nbsp;<font color="Blue">this</font>.FormBorderStyle = FormBorderStyle.FixedDialog;<br />&nbsp;&nbsp;<font color="Blue">this</font>.WindowState = FormWindowState.Normal;<br />&nbsp;&nbsp;<font color="Blue">this</font>.ControlBox = <font color="Blue">true</font>;<br />&nbsp;&nbsp;<font color="Blue">this</font>.MinimizeBox = <font color="Blue">true</font>;<br />&nbsp;&nbsp;<font color="Blue">this</font>.MaximizeBox = <font color="Blue">true</font>;<br /><br />&nbsp;&nbsp;<font color="Green">// Since there is no WindowState.Minimize, we have to P/Invoke ShowWindow</font><br />&nbsp;&nbsp;ShowWindow(this.Handle, SW_MINIMIZED);<br />}<br /></font>